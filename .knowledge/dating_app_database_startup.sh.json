{"is_source_file": true, "format": "bash/shell script", "description": "This file is a shell script used to initialize and start a PostgreSQL database server with specific configuration and setup routines, including setting permissions, creating roles and databases, and ensuring readiness.", "external_files": ["/usr/lib/postgresql/${PG_VERSION}/bin/initdb", "/usr/lib/postgresql/${PG_VERSION}/bin/postgres", "/usr/lib/postgresql/${PG_VERSION}/bin/pg_isready", "/usr/lib/postgresql/${PG_VERSION}/bin/psql", "/usr/lib/postgresql/${PG_VERSION}/bin/createdb"], "external_methods": ["ls", "mkdir", "test", "command -v", "sudo", "cat", "echo", "sleep", "grep", "format", "> (redirect operator)"], "published": ["db_connection.txt"], "classes": [], "methods": [{"name": "ensure_dir", "description": "Creates the specified directory if it does not exist."}, {"name": "is_writable_dir", "description": "Checks if a directory exists and is writable."}, {"name": "set_perms", "description": "Sets ownership and permissions for a given directory, using sudo if available."}, {"name": "run_as_postgres", "description": "Runs a command as the postgres user if sudo is available, otherwise runs it directly."}], "calls": ["ls /usr/lib/postgresql/", "mkdir -p", "[ -d \"$dir\" ]", "[ -w \"$dir\" ]", "command -v sudo", "sudo chown -R postgres:postgres", "sudo chmod 700", "chmod 700", "sudo -u postgres", "sudo -u postgres \"$@\"", "run_as_postgres \"${PG_BIN}/initdb\" -D \"${PGDATA_DIR}\"", "run_as_postgres \"${PG_BIN}/postgres\" -D \"${PGDATA_DIR}\" -p \"${DB_PORT}\" -c listen_addresses='*' &", "run_as_postgres \"${PG_BIN}/pg_isready\" -h 127.0.0.1 -p \"${DB_PORT}\" -d \"${DB_NAME}\" -U \"${DB_USER}\"", "run_as_postgres \"${PG_BIN}/psql\" -p \"${DB_PORT}\" -d postgres", "run_as_postgres \"${PG_BIN}/createdb\" -p \"${DB_PORT}\" \"${DB_NAME}\"", "run_as_postgres \"${PG_BIN}/psql\" -p \"${DB_PORT}\" -d \"${DB_NAME}\"", "echo \"psql postgresql://${DB_USER}:${DB_PASSWORD}@localhost:${DB_PORT}/${DB_NAME}\" > db_connection.txt"], "search-terms": ["PostgreSQL setup", "startup script", "database initialization", "pg_hba.conf configuration", "database role creation", "port configuration"], "state": 2, "file_id": 2, "knowledge_revision": 79, "git_revision": "10ed60fd1e9a84681e856442596c4d1080d5dada", "revision_history": [{"10": "aa2696d67db50323b0bdb66821dd0ab0f255f962"}, {"16": "aa2696d67db50323b0bdb66821dd0ab0f255f962"}, {"19": "5ede99d03854b5e51279fae2c161cd5b0172d823"}, {"24": "e6a689ec89660788b00d91d66d6a7d990b9aad75"}, {"39": "451ce8bb005c5345adb0a1ad23ff822ae84b68b2"}, {"79": "10ed60fd1e9a84681e856442596c4d1080d5dada"}], "hash": "1b9b6b3dee73d4e9ac26b63a8c189650", "format-version": 4, "code-base-name": "dating_app_database", "filename": "dating_app_database/startup.sh"}